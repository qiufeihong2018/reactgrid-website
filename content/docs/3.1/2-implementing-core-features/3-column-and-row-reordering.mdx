---
posttype: "docs"
title: Column and row reordering
metaTitle: "Column and row reordering"
metaDescription: "ReactGrid docs"
proMark: true
---
import { ReactGrid } from "@silevis/reactgrid";
const code = `interface Person {
    id: number;
    name: string;
    surname: string;
}
${``}
const getPeople = (): Person[] => [
    { id: 1, name: "Thomas", surname: "Goldman" },
    { id: 2, name: "Susie", surname: "Quattro" },
    { id: 3, name: "", surname: "" }
];
${``}
declare module "@silevis/reactgrid" {
    interface Column {
        columnId: ColumnId;
    }
}
${``}
interface ColumnMap {
    name: 'Name';
    surname: 'Surname';
}
${``}
const columnMap: ColumnMap = {
    name: 'Name',
    surname: 'Surname'
};
${``}
type ColumnId = keyof ColumnMap;
${``}
const getColumns = (): Column[] => [
    { columnId: 'name', width: 150, reorderable: true },
    { columnId: 'surname', width: 200, reorderable: true }
];
${``}
const getRows = (people: Person[], columnsOrder: ColumnId[]): Row[] => {
    return [
        {
            rowId: "header",
            cells: [
                { type: "header", text: columnMap[columnsOrder[0]] },
                { type: "header", text: columnMap[columnsOrder[1]] }
            ]
        },
        ...people.map<Row>((person, idx) => ({
            rowId: person.id,
            reorderable: true,
            cells: [
                { type: "text", text: person[columnsOrder[0]] },
                { type: "text", text: person[columnsOrder[1]] }
            ]
        }))
    ]
};
${``}
const reorderArray = <T extends {}>(arr: T[], idxs: number[], to: number) => {
    const movedElements = arr.filter((_, idx) => idxs.includes(idx));
    const targetIdx = Math.min(...idxs) < to ? to += 1 : to -= idxs.filter(idx => idx < to).length;
    const leftSide = arr.filter((_, idx) => idx < targetIdx && !idxs.includes(idx));
    const rightSide = arr.filter((_, idx) => idx >= targetIdx && !idxs.includes(idx));
    return [...leftSide, ...movedElements, ...rightSide];
}
${``}
const handleCanReorderRows = (targetRowId: Id, rowIds: Id[], dropPosition: DropPosition): boolean => {
    return targetRowId !== 'header';
}
${``}
const ColumnsAndRowsReorderSample = () => {
    const [people, setPeople] = React.useState<Person[]>(getPeople());
    const [columns, setColumns] = React.useState<Column[]>(getColumns());
    ${``}
    const rows = getRows(people, columns.map(c => c.columnId));
    ${``}
    const handleColumnsReorder = (targetColumnId: Id, columnIds: Id[], dropPosition: DropPosition) => {
        const to = columns.findIndex((column) => column.columnId === targetColumnId);
        const columnIdxs = columnIds.map((columnId) => columns.findIndex((c) => c.columnId === columnId));
        setColumns(prevColumns => reorderArray(prevColumns, columnIdxs, to));
    }
    ${``}
    const handleRowsReorder = (targetRowId: Id, rowIds: Id[], dropPosition: DropPosition) => {
        setPeople((prevPeople) => {
            const to = people.findIndex(person => person.id === targetRowId);
            const rowsIds = rowIds.map((id) => people.findIndex(person => person.id === id));
            return [...reorderArray(prevPeople, rowsIds, to)];
        });
    }
    ${``} 
    return <ReactGrid
        rows={rows}
        columns={columns}
        onColumnsReordered={handleColumnsReorder}
        onRowsReordered={handleRowsReorder}
        canReorderRows={handleCanReorderRows}
        enableRowSelection
        enableColumnSelection
    />;
}
${``}
render(<ColumnsAndRowsReorderSample/>)
`;

#### How to implement column and row reordering?

<Alert color="primary">
	<i class="fas fa-exclamation-circle pr-3"></i>
	This feature is only available in PRO version
</Alert>

This guide is based on [getting started](/docs/3.1/1-getting-started/).

#### 1. Update person interface and people data

Our `Person` interface will be extended with the `id` field. It's necessary to identify person to keep correct order after
row reorder action.

```tsx
interface Person {
  id: number;
  name: string;
  surname: string;
}

const getPeople = (): Person[] => [
  { id: 1, name: "Thomas", surname: "Goldman" },
  { id: 2, name: "Susie", surname: "Quattro" },
  { id: 3, name: "", surname: "" }
];
```

#### 2. Update column related properties

In our sample we will be able to see and reorder two column. 
We currenly working with column that we know everything about their destiny.
Let's define coresponding interface that is personalized stricly to our needs.

```tsx
interface ColumnMap {
  name: 'Name';
  surname: 'Surname';
}

const columnMap: ColumnMap = {
  name: 'Name',
  surname: 'Surname'
};
```

ReactGrid's `Column` interface contains `columnId` property. You can assign to this property any `string` or even `number`.
In this example we know that we working with only `name` and `surname` as so we can augument `Column` 
interface definition by doing this:

```tsx
type ColumnId = keyof ColumnMap;
```

#### 3. Make your columns reorderable

This step is simply - just add `reorderable: true` to the column definitions.

```tsx
const getColumns = (): Column[] => [
  { columnId: 'name', width: 150, reorderable: true }, // highlight-line
  { columnId: 'surname', width: 200, reorderable: true } // highlight-line
];
```

#### 4. Display rows with arbitrary columns order

Relative to base example we need to add a one mode argument: `columnsOrder`. 
This parameter contains columns key (`name` or `surname`) in order that we went to display people.
We also moved `headerRow` and replace it with object to get coresponding column title and value of `columnMap`.
Also cells inside mapped `people` array selects persons attribute accordingly to columns order.

```tsx
const getRows = (people: Person[], columnsOrder: ColumnId[]): Row[] => {
  return [
    {
      rowId: "header",
      cells: [
        { type: "header", text: columnMap[columnsOrder[0]] },
        { type: "header", text: columnMap[columnsOrder[1]] }
      ]
    },
    ...people.map<Row>((person, idx) => ({
      rowId: person.id,
      reorderable: true,
      cells: [
        { type: "text", text: person[columnsOrder[0]] }, // `person['name']` / `person['surname']`
        { type: "text", text: person[columnsOrder[1]] } // `person['surname']` / `person['name']`
      ]
    }))
  ]
};
```

`reorderArray` function is used to order columns or rows. You can just copy it.

```ts
// a helper function used to reorder arbitrary arrays
const reorderArray = <T extends {}>(arr: T[], idxs: number[], to: number) => {
    const movedElements = arr.filter((_, idx) => idxs.includes(idx));
    const targetIdx = Math.min(...idxs) < to ? to += 1 : to -= idxs.filter(idx => idx < to).length;
    const leftSide = arr.filter((_, idx) => idx < targetIdx && !idxs.includes(idx));
    const rightSide = arr.filter((_, idx) => idx >= targetIdx && !idxs.includes(idx));
    return [...leftSide, ...movedElements, ...rightSide];
}
```

#### 5.  Implement column and row handlers

All that remains to write handler for rows and column reordering. 
Column and row reorder handler are based on searching for destination target index and mapping reordered items to array
ot their occurrence. After that we pass previously mentioned indexes to `reorderArray` function and update data by calling 
`setColumns` and `setPeople`.
`ReactGrid` component needs to have enabled `enableRowSelection` and `enableColumnSelection`.

```tsx
const ColumnsAndRowsReorderSample = () => {
    const [people, setPeople] = React.useState<Person[]>(getPeople());
    const [columns, setColumns] = React.useState<Column[]>(getColumns());

    const rows = getRows(people, columns.map(c => c.columnId as ColumnId));

    const handleColumnsReorder = (targetColumnId: Id, columnIds: Id[]) => {
        const to = columns.findIndex((column) => column.columnId === targetColumnId);
        const columnIdxs = columnIds.map((columnId) => columns.findIndex((c) => c.columnId === columnId));
        setColumns(prevColumns => reorderArray(prevColumns, columnIdxs, to));
    }

    const handleRowsReorder = (targetRowId: Id, rowIds: Id[]) => {
        setPeople((prevPeople) => {
            const to = people.findIndex(person => person.id === targetRowId);
            const rowsIds = rowIds.map((id) => people.findIndex(person => person.id === id));
            return reorderArray(prevPeople, rowsIds, to);
        });
    }

    return <ReactGrid
        rows={rows}
        columns={columns}
        onColumnsReordered={handleColumnsReorder}
        onRowsReordered={handleRowsReorder}
        enableRowSelection
        enableColumnSelection
    />;
}
```

#### Bonus - preventing dropping rows on unwanted location

This 'feature' can be done by making `handleCanReorderRows` function and passing it to `canReorderRows` ReactGrid prop.
We also provided `canReorderColumns` prop that can do the same thing, but with columns. 

While you reorder row you can see the line that is visible above the  header row. We probably don't want to mislead end user
that he can drop row over there. 

When you drop row then your `handleCanReorderRows` is fired. We can define that dropping over row that its `rowId` field equals
`header` is prohibited. In this case you won't see reorder line indication and `handleRowsReorder` is not fired by default.

```ts
const handleCanReorderRows = (targetRowId: Id, rowIds: Id[]): boolean => {
    return targetRowId !== 'header';
}
```

```ts
const ColumnsAndRowsReorderSample = () => {
   // ...
    return <ReactGrid
        rows={rows}
        columns={columns}
        onColumnsReordered={handleColumnsReorder}
        onRowsReordered={handleRowsReorder}
        enableRowSelection
        enableColumnSelection
        canReorderRows={handleCanReorderRows} // highlight-line
    />;
}
```

#### Live demo

<LiveCode 
  code={code}
  title='Column and row reordering live demo'
  noInline={true}
/> 