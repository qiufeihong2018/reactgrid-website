---
posttype: "docs"
title: Undo / Redo feauture
metaTitle: "Undo / Redo feauture"
metaDescription: "ReactGrid docs"
---

#### Idea of Undo / Redo feature

1. An Undo / Redo feature should be implemented by the user, but we prepared example which you can use.
2. ReactGrid is not handling `ctrl+z` and `ctrl+y` events internally.
3. You can handle `onKeyDown` event to use your own implemented Undo / Redo feature.
4. The `ReactGrid` component receives revoked or restored data and gets rerendered.

It's possible to use with keyboard `ctrl+z` and `ctrl+y` shortcuts or prepared by you buttons.

#### When is my handler functions called?

1. Changes have been committed after `ctrl+z` and `ctrl+y` key.
2. Changes have been committed after `Undo` and `Redo` button.

#### Implementing feature in your project

This feauture is connected with [handling changes](/docs/3.1/2-implementing-core-features/1-handling-changes/).


Let's start with updating imports:

```ts
import { ReactGrid, Column, Row, CellChange, TextCell} from "@silevis/reactgrid";
```

#### Sample Undo / Redo feature

We are prepared specially for you functions which you can use and adjust to your project.
We have a stack of changes made by the user at each step. The place in the history of changes you are in is remembered.
Look at this functions:

```tsx
  const applyNewValue = (
    changes: CellChange<TextCell>[],
    prevPeople: Person[],
    usePrevValue: boolean = false
  ): Person[] => {
    changes.forEach((change) => {
      const personIndex = change.rowId;
      const fieldName = change.columnId;
      const cell = usePrevValue ? change.previousCell : change.newCell;
      prevPeople[personIndex][fieldName] = cell.text;
    });
    return [...prevPeople];
  };
```
Function `applyChangesToPeople` is similar function which is responsible for handling changes.
We need additionally to set all changes and changes index.

```tsx
    const applyChangesToPeople = (
    changes: CellChange<TextCell>[],
    prevPeople: Person[]
  ): Person[] => {
    const updated = applyNewValue(changes, prevPeople);
    setCellChanges([...cellChanges.slice(0, cellChangesIndex + 1), changes]);
    setCellChangesIndex(cellChangesIndex + 1);
    return updated;
  };
```

The `undoChanges` function allows you to set the previous value and change the index in the appropriate place in the array.

```tsx
  const undoChanges = (
    changes: CellChange<TextCell>[],
    prevPeople: Person[]
  ): Person[] => {
    const updated = applyNewValue(changes, prevPeople, true);
    setCellChangesIndex(cellChangesIndex - 1);
    return updated;
  };
```
The `redoChanges` function allows you to set the restored value and change the index in the appropriate place in the array.

```tsx
  const redoChanges = (
    changes: CellChange<TextCell>[],
    prevPeople: Person[]
  ): Person[] => {
    const updated = applyNewValue(changes, prevPeople);
    setCellChangesIndex(cellChangesIndex + 1);
    return updated;
  };
```

Let's use the above functions to our ReactGrid component:

```tsx
function App() {
  const [people, setPeople] = React.useState<Person[]>(getPeople());

  const [cellChangesIndex, setCellChangesIndex] = React.useState(() => -1);
  const [cellChanges, setCellChanges] = React.useState<CellChange<TextCell>[][]>(() => []);
  
  const rows = getRows(people);
  const columns = getColumns();

  const handleChanges = (changes: CellChange<TextCell>[]) => { 
    setPeople((prevPeople) => applyChangesToPeople(changes, prevPeople)); 
  }; 

  const handleUndoChanges = () => {
    if (cellChangesIndex >= 0) {
      setPeople((prevPeople) =>
        undoChanges(cellChanges[cellChangesIndex], prevPeople)
      );
    }
  };

  const handleRedoChanges = () => {
    if (cellChangesIndex + 1 <= cellChanges.length - 1) {
      setPeople((prevPeople) =>
        redoChanges(cellChanges[cellChangesIndex + 1], prevPeople)
      );
    }
  };

  return (
    <div
      onKeyDown={(e) => {
        if ((!isMacOs() && e.ctrlKey) || e.metaKey) {
          switch (e.key) {
            case "z":
              handleUndoChanges();
              return;
            case "y":
              handleRedoChanges();
              return;
          }
        }
      }}
    >
      <ReactGrid rows={rows} columns={columns} onCellsChanged={handleChanges} />
      <button onClick={handleUndoChanges}>Undo</button>
      <button onClick={handleRedoChanges}>Redo</button>
    </div>
  );
}
```

#### Live demo

And here's an interactive demo showing the Undo / Redo feature.

<iframe src="https://codesandbox.io/embed/undo-redo-feature-dpozf?fontsize=14&hidenavigation=1&theme=dark"
  style="width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;"
  title="reactgrid-undo-redo-feature"
  allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking"
  sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"
></iframe>